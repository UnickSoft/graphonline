function var_dump(e,t){var n="";if(!t)t=0;var r="";for(var i=0;i<t+1;i++)r+="    ";if(typeof e=="object"){for(var s in e){var o=e[s];if(typeof o=="object"){n+=r+"'"+s+"' ...\n";n+=var_dump(o,t+1)}else{n+=r+"'"+s+"' => \""+o+'"\n'}}}else{n="===>"+e+"<===("+typeof e+")"}return n}var IMG_PARAM={URL:0,TITLE:1,ALT:2,WIDTH:3,HEIGHT:4};var pluginPath=CKEDITOR.plugins.get("slideshow").path;SCRIPT_JQUERY="https://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js";SCRIPT_ADDGAL=pluginPath+"3rdParty/ad-gallery/jquery.ad-gallery.min.js";CSS_ADDGAL=pluginPath+"3rdParty/ad-gallery/jquery.ad-gallery.css";SCRIPT_FANCYBOX=pluginPath+"3rdParty/fancybox2/jquery.fancybox.pack.js?v=2.1.5";CSS_FANCYBOX=pluginPath+"3rdParty/fancybox2/jquery.fancybox.css?v=2.1.5";var listItem=function(e){return e.type==CKEDITOR.NODE_ELEMENT&&e.is("li")};var ULItem=function(e){return e.type==CKEDITOR.NODE_ELEMENT&&e.is("ul")};var iFrameItem=function(e){return e.type==CKEDITOR.NODE_ELEMENT&&e.is("iframe")};Array.prototype.pushUnique=function(e){for(var t=0;t<this.length;t++){if(this[t][0]==e[0])return-1}this.push(e);return this.length-1};Array.prototype.updateVal=function(e,t){for(var n=0;n<this.length;n++){if(this[n][0]==e){this[n]=[e,t];return true}}this[n]=[e,t];return false};Array.prototype.getVal=function(e){for(var t=0;t<this.length;t++){if(this[t][0]==e){return this[t][1]}}return null};CKEDITOR.dialog.add("slideshowDialog",function(e){function n(e,t,n,r,i){e=l(e);var s;if(r)s=r.createElement("OPTION");else s=document.createElement("OPTION");if(e&&s&&s.getName()=="option"){if(CKEDITOR.env.ie){if(!isNaN(parseInt(i,10)))e.$.options.add(s.$,i);else e.$.options.add(s.$);s.$.innerHTML=t.length>0?t:"";s.$.value=n}else{if(i!==null&&i<e.getChildCount())e.getChild(i<0?0:i).insertBeforeMe(s);else e.append(s);s.setText(t.length>0?t:"");s.setValue(n)}}else{return false}return s}function r(e){e=l(e);var t=u(e);for(var n=e.getChildren().count()-1;n>=0;n--){if(e.getChild(n).$.selected)e.getChild(n).remove()}a(e,t)}function i(e,t,n,r){e=l(e);if(t<0)return false;var i=e.getChild(t);i.setText(n);i.setValue(r);return i}function s(e){e=l(e);while(e.getChild(0)&&e.getChild(0).remove()){}}function o(e,t,r){e=l(e);var i=u(e);if(i<0)return false;var s=i+t;s=s<0?0:s;s=s>=e.getChildCount()?e.getChildCount()-1:s;if(i==s)return false;var o=e.getChild(i),f=o.getText(),c=o.getValue();o.remove();o=n(e,f,c,!r?null:r,s);a(e,s);return o}function u(e){e=l(e);return e?e.$.selectedIndex:-1}function a(e,t){e=l(e);if(t<0)return null;var n=e.getChildren().count();e.$.selectedIndex=t>=n?n-1:t;return e}function f(e){e=l(e);return e?e.getChildren():false}function l(e){if(e&&e.domId&&e.getInputElement().$)return e.getInputElement();else if(e&&e.$)return e;return false}function c(e){var t=e.getContentElement("slideshowinfoid","editselectedbtn");var n=e.getContentElement("slideshowinfoid","removeselectedbtn");t=l(t);t.hide();n=l(n);n.hide();var r=e.getContentElement("slideshowinfoid","imglistitemsid");r=l(r);for(var i=r.getChildren().count()-1;i>=0;i--){r.getChild(i).$.selected=false}}function h(e){var t=e.getDialog();var n=null;e=l(e);var r=0;var i=t.getContentElement("slideshowinfoid","editselectedbtn");var s=t.getContentElement("slideshowinfoid","removeselectedbtn");for(var o=e.getChildren().count()-1;o>=0;o--){var u=e.getChild(o);if(u.$.selected){r++;n=u}}if(r>1){c(t);return null}else{if(r==1){i=l(i);i.show();s=l(s);s.show();p(t);return n}}return null}function p(e){if(e.openCloseStep==true)return;var t=e.getContentElement("slideshowinfoid","framepreviewid");if(t.isVisible()){T(e)}else{y(e)}}function d(e){var t=e.getDialog();e=l(e);var n=0;for(var r=0;r<e.getChildren().count();r++){var i=e.getChild(r);if(i.$.selected){selectefItem=i;n=r;break}}a(e,n);p(t)}function v(e){var t=e.getContentElement("slideshowinfoid","imglistitemsid");return u(t)}function m(e){var t=CKEDITOR.basePath+"plugins/slideshow/icons/placeholder.png";if(e.imagesList.length==1&&e.imagesList[0][IMG_PARAM.URL]==t){var n=e.getContentElement("slideshowinfoid","imglistitemsid");n=l(n);var r=0;e.imagesList.splice(r,1);n.getChild(r).remove()}}function g(e){m(e);var t=e.previewImage;var r=t.$.src;var i=t.$.width/t.$.height;var s=50;var o=50;if(i>1){o=o/i}else{s=s*i}var u=e.imagesList.pushUnique([r,"","",s.toFixed(0),o.toFixed(0)]);if(u>=0){oOption=n(combo,"IMG_"+u+" : "+r.substring(r.lastIndexOf("/")+1),r,e.getParentEditor().document);a(combo,u);p(e)}}function y(e){var t=e.getContentElement("slideshowinfoid","imglistitemsid");var n=u(t);var r=e.imagesList[n];t=e.getContentElement("slideshowinfoid","imgtitleid");t=l(t);t.setValue(r[1]);t=e.getContentElement("slideshowinfoid","imgdescid");t=l(t);t.setValue(r[2]);t=e.getContentElement("slideshowinfoid","imgpreviewid");t=l(t);var i='<div style="text-align:center;"> <img src="'+r[0]+'" title="'+r[1]+'" alt="'+r[2]+'" style=" max-height: 200px;  max-width: 350px;'+'"> </div>';t.setHtml(i);var s=e.getContentElement("slideshowinfoid","framepreviewid");var o=e.getContentElement("slideshowinfoid","imgparamsid");s=l(s);s.hide();o=l(o);o.show()}function b(e){var r=e.getContentElement("slideshowinfoid","imglistitemsid");r=l(r);var i=false;for(var s=r.getChildren().count()-1;s>=0;s--){if(r.getChild(s).$.selected){e.imagesList.splice(s,1);r.getChild(s).remove();i=true}}if(i){if(e.imagesList.length==0){var o=CKEDITOR.basePath+"plugins/slideshow/icons/placeholder.png";oOption=n(r,"IMG_0"+" : "+o.substring(o.lastIndexOf("/")+1),o,e.getParentEditor().document);e.imagesList.pushUnique([o,t.imgTitle,t.imgDesc,"50","50"])}a(r,0);p(e)}}function S(e,t){e.imagesList[v(e)][IMG_PARAM.TITLE]=t;y(e)}function x(e,t){e.imagesList[v(e)][IMG_PARAM.ALT]=t;y(e)}function T(e){var t=e.getContentElement("slideshowinfoid","framepreviewid");var n=e.getContentElement("slideshowinfoid","imgparamsid");n=l(n);n.hide();t=l(t);t.show();C(e)}function N(e,t){e.open();e.writeln(t);e.close()}function C(e){var t=436;var n=300;if(e.params.getVal("showthumbid")==true){n-=120}else if(e.params.getVal("showcontrolid")==true){n-=30}if(e.imagesList.length==0)return;var r=e.getContentElement("slideshowinfoid","imglistitemsid");var i=u(r);if(i<0)i=0;var r=e.getContentElement("slideshowinfoid","framepreviewid");var s="";s+="<head>";s+='<script src="'+SCRIPT_JQUERY+'" type="text/javascript"></script>';s+='<script type="text/javascript" src="'+SCRIPT_ADDGAL+'"></script>';s+='<link rel="stylesheet" type="text/css" href="'+CSS_ADDGAL+'" />';if(e.params.getVal("openOnClickId")==true){s+='<link rel="stylesheet" type="text/css" href="'+CSS_FANCYBOX+'" />';s+='<script type="text/javascript" src="'+SCRIPT_FANCYBOX+'"></script>';s+='<script type="text/javascript">';s+=j(e);s+="</script>"}s+='<script type="text/javascript">';s+=B(e,i,t,n);s+="</script>";s+="</head>";s+="<body>";var o=I(e);s+=o.getOuterHtml();s+="</body>";s+="";r=l(r);var a=r.getFirst(iFrameItem);if(a)a.remove();var f=null;var c=t+60;var h=n;if(e.params.getVal("showthumbid")==true){h+=120}else if(e.params.getVal("showcontrolid")==true){h+=30}var p=CKEDITOR.dom.element.createFromHtml("<iframe"+' style="width:'+c+"px;height:"+h+'px;background:azure; "'+' class="cke_pasteframe"'+' frameborder="10" '+' allowTransparency="false"'+' role="region"'+' scrolling="no"'+"></iframe>");p.setAttribute("name","totoFrame");p.setAttribute("id","totoFrame");p.on("load",function(e){if(f!=null)return;f=this.$;if(f.contentDocument)iframedoc=f.contentDocument;else if(f.contentWindow)iframedoc=f.contentWindow.document;if(iframedoc){N(iframedoc,s)}else{alert("Cannot inject dynamic contents into iframe.")}});r.append(p)}function k(e,t){var r,i,s;var o,u;var f=t.$.getElementsByTagName("img");combo=e.getContentElement("slideshowinfoid","imglistitemsid");for(r=0;r<f.length;r++){i=f[r];s=i.src;o=i.width;if(o==0)o=i.naturalWidth;if(o==0){o=50;u=50}else{u=i.height;if(u==0)u=i.naturalHeight;if(u==0){o=50;u=50}}var l=o/u;var c=50;var h=50;if(l>1){h=h/l}else{c=c*l}var d=e.imagesList.pushUnique([s,i.title,i.alt,c,h]);if(d>=0){oOption=n(combo,"IMG_"+d+" : "+s.substring(s.lastIndexOf("/")+1),s,e.getParentEditor().document)}}a(combo,0);p(e)}function L(e){combo=e.getContentElement("slideshowinfoid","imglistitemsid");var r=CKEDITOR.basePath+"plugins/slideshow/icons/placeholder.png";oOption=n(combo,"IMG_0"+" : "+r.substring(r.lastIndexOf("/")+1),r,e.getParentEditor().document);e.imagesList.pushUnique([r,t.imgTitle,t.imgDesc,"50","50"]);a(combo,0);p(e)}function A(e){e.slideshowDOM.setAttribute("data-"+this.id,this.getValue())}function O(){var e=this.getDialog();if(e.newSlideShowMode){e.slideshowDOM.setAttribute("data-"+this.id,this.getValue());switch(this.type){case"checkbox":break;case"text":break;case"select":break;default:}}else{switch(this.type){case"checkbox":this.setValue(e.slideshowDOM.getAttribute("data-"+this.id)=="true");break;case"text":this.setValue(e.slideshowDOM.getAttribute("data-"+this.id));break;case"select":this.setValue(e.slideshowDOM.getAttribute("data-"+this.id));break;default:}}}function M(){var e=this.getDialog();e.params.updateVal(this.id,this.getValue());switch(this.type){case"checkbox":break;case"text":break;case"select":break;default:}p(e)}function _(e){if(e.previewImage){e.previewImage.removeListener("load",w);e.previewImage.removeListener("error",E);e.previewImage.removeListener("abort",E);e.previewImage.remove();e.previewImage=null}e.imagesList=null;e.params=null;e.slideshowDOM=null;combo=e.getContentElement("slideshowinfoid","imglistitemsid");s(combo);e.openCloseStep=false}function D(e){var t="";while(t.length<e){t+=Math.random().toString(36).substring(2)}return t.substring(0,e)}function H(e,t){var n=t.getElementsByTag("ul");if(n==null)return null;if(n.count()==1){return n.getItem(0)}return null}function B(e,t,n,r){var i=e.params.getVal("slideshowid");var s="ad-gallery_"+i;var o="";var u="";o+="$(function() {";if(n==0)n="false";if(r==0)r=e.params.getVal("pictheightid");if(e.params.getVal("showtitleid")==false){u=",  hooks: { displayDescription: function(image) {}}"}var a="loader_image: '"+pluginPath+"3rdParty/ad-gallery/loader.gif',"+" width:"+n+", height:"+r+", start_at_index: "+t+", animation_speed: "+e.params.getVal("animspeedid")+u+", update_window_hash: false, effect: '"+e.params.getVal("transitiontypeid")+"',";var f=" slideshow: { enable: true, autostart: "+e.params.getVal("autostartid")+", speed: "+e.params.getVal("speedid")*1e3+",},";o+="   var galleries = $('#"+s+"').adGallery({"+a+f+"});";o+="});";return o}function j(e){var t=e.params.getVal("slideshowid");var n="ad-gallery_"+t;var r="";r+="$(function() {";r+='$("#'+n+'").on("click",".ad-image",function(){';r+='var imgObj =$(this).find("img");';r+='var isrc=imgObj.attr("src");';r+="var ititle=null;";r+="var idesc=null;";r+="var iname=isrc.split('/');";r+="iname=iname[iname.length-1];";r+='var imgdescid=$(this).find(".ad-image-description");';r+="if(imgdescid){";r+='ititle=$(this).find(".ad-description-title");';r+="if(ititle)ititle=ititle.text();";r+="if(ititle!='')ititle='<big>'+ititle+'</big>';";r+='idesc=$(this).find("span");';r+="if(idesc)idesc=idesc.text();";r+="if(idesc!=''){";r+="if(ititle!='')ititle=ititle+'<br>';";r+="idesc='<i>'+idesc+'</i>';";r+="}";r+="}";r+="$.fancybox.open({";r+="href:isrc,";r+="beforeLoad:function(){";r+="this.title=ititle+idesc;";r+="},";r+="});";r+="});";r+="});";return r}function F(e,t){for(var n=0;n<e.imagesList.length;n++){var r=t.append("li");r.setAttribute("contenteditable","false");aObj=r.append("a");aObj.setAttribute("href",e.imagesList[n][IMG_PARAM.URL]);aObj.setAttribute("contenteditable","false");newImgDOM=aObj.append("img");newImgDOM.setAttribute("src",e.imagesList[n][IMG_PARAM.URL]);newImgDOM.setAttribute("title",e.imagesList[n][IMG_PARAM.TITLE]);newImgDOM.setAttribute("alt",e.imagesList[n][IMG_PARAM.ALT]);newImgDOM.setAttribute("contenteditable","false");newImgDOM.setAttribute("width",e.imagesList[n][IMG_PARAM.WIDTH]);newImgDOM.setAttribute("height",e.imagesList[n][IMG_PARAM.HEIGHT])}}function I(t){var n=t.params.getVal("slideshowid");var r="ad-gallery_"+n;var i="display: block;";var s="display: block;";if(t.params.getVal("showthumbid")==false){i="display: none;"}if(t.params.getVal("showcontrolid")==false){s="visibility: hidden;"}var o=e.document.createElement("div");o.setAttribute("id",n);o.setAttribute("class","slideshowPlugin");o.setAttribute("contenteditable","false");var u=o.append("div");u.setAttribute("class","ad-gallery");u.setAttribute("contenteditable","false");u.setAttribute("id",r);var a=u.append("div");a.setAttribute("class","ad-image-wrapper");a.setAttribute("contenteditable","false");var f=u.append("div");f.setAttribute("class","ad-controls");f.setAttribute("contenteditable","false");f.setAttribute("style",s);var l=u.append("div");l.setAttribute("class","ad-nav");l.setAttribute("style",i);l.setAttribute("contenteditable","false");var c=l.append("div");c.setAttribute("class","ad-thumbs");c.setAttribute("contenteditable","false");var h=c.append("ul");h.setAttribute("class","ad-thumb-list");h.setAttribute("contenteditable","false");F(t,h);return o}function q(t){var n={},r={};t.openCloseStep=true;t.commitContent(t);var i=I(t);for(var s=0;s<t.params.length;s++){i.data(t.params[s][0],t.params[s][1])}var o=CKEDITOR.document.createElement("script",{attributes:{type:"text/javascript",src:SCRIPT_ADDGAL}});i.append(o);if(t.params.getVal("openOnClickId")==true){var u=CKEDITOR.document.createElement("script",{attributes:{type:"text/javascript"}});u.setText("$('head').append('<link rel=\"stylesheet\" href=\""+CSS_FANCYBOX+'" type="text/css" />\');');i.append(u);var a=CKEDITOR.document.createElement("script",{attributes:{type:"text/javascript",src:SCRIPT_FANCYBOX}});i.append(a);var f=CKEDITOR.document.createElement("script",{attributes:{type:"text/javascript"}});f.setText(j(t));i.append(f)}var l=CKEDITOR.document.createElement("script",{attributes:{type:"text/javascript"}});l.setText("$('head').append('<link rel=\"stylesheet\" href=\""+CSS_ADDGAL+'" type="text/css" />\');');i.append(l);var c=CKEDITOR.document.createElement("script",{attributes:{type:"text/javascript"}});c.setText(B(t,0,0,0));i.append(c);if(t.imagesList.length){n.backgroundImage='url("'+t.imagesList[0][IMG_PARAM.URL]+'")'}n.backgroundSize="50%";n.display="block";var h=e.createFakeElement(i,"cke_slideShow","slideShow",false);h.setAttributes(r);h.setStyles(n);if(t.fakeImage){h.replace(t.fakeImage);e.getSelection().selectElement(h)}else{e.insertElement(h)}_(t);t.hide();return true}var t=e.lang.slideshow;var w=function(){var e=this.previewImage;e.removeListener("load",w);e.removeListener("error",E);e.removeListener("abort",E);g(this)};var E=function(){var e=this.previewImage;e.removeListener("load",w);e.removeListener("error",E);e.removeListener("abort",E)};var P=function(e){return"cke_"+D(8)+"_"+e};return{title:t.dialogTitle,width:500,height:600,resizable:CKEDITOR.DIALOG_RESIZE_NONE,buttons:[CKEDITOR.dialog.okButton(e,{label:"OkCK",style:"display:none;"}),CKEDITOR.dialog.cancelButton,{id:"myokbtnid",type:"button",label:"OK",title:"Button description",style:"color:white;background:blue;",accessKey:"C",disabled:false,onClick:function(){q(this.getDialog())}}],contents:[{id:"slideshowinfoid",label:"Basic Settings",align:"center",elements:[{type:"text",id:"id",style:"display:none;",onLoad:function(){this.getInputElement().setAttribute("readOnly",true)}},{type:"text",id:"txturlid",style:"display:none;",label:t.imgList,onChange:function(){var e=this.getDialog(),t=this.getValue();if(t.length>0){var n=e.previewImage;n.on("load",w,e);n.on("error",E,e);n.on("abort",E,e);n.setAttribute("src",t)}}},{type:"button",id:"browse",hidden:"true",style:"display:inline-block;margin-top:0px;",filebrowser:{action:"Browse",target:"slideshowinfoid:txturlid",url:e.config.filebrowserImageBrowseUrl||e.config.filebrowserBrowseUrl},label:t.imgAdd},{type:"vbox",align:"center",children:[{type:"html",align:"center",id:"framepreviewtitleid",style:"font-family: Amaranth; color: #1E66EB;	font-size: 20px; font-weight: bold;",html:"Preview"},{type:"html",id:"framepreviewid",align:"center",style:"width:500px;height:320px",html:""},{type:"hbox",id:"imgparamsid",style:"display:none;width:500px;",height:"325px",children:[{type:"vbox",align:"center",width:"400px",children:[{type:"text",id:"imgtitleid",label:t.imgTitle,onChange:function(){if(this.getValue()){S(this.getDialog(),this.getValue())}}},{type:"text",id:"imgdescid",label:t.imgDesc,onChange:function(){if(this.getValue()){x(this.getDialog(),this.getValue())}}},{type:"html",id:"imgpreviewid",style:"width:400px;height:200px;",html:"<div>xx</div>"}]}]},{type:"hbox",align:"center",height:110,widths:["25%","50%"],children:[{type:"vbox",children:[{type:"checkbox",id:"autostartid",label:t.autoStart,"default":"checked",style:"margin-top:15px;",onChange:M,commit:M,setup:O},{type:"checkbox",id:"showtitleid",label:t.showTitle,"default":"checked",onChange:M,commit:M,setup:O},{type:"checkbox",id:"showcontrolid",label:t.showControls,"default":"checked",onChange:M,commit:M,setup:O},{type:"checkbox",id:"showthumbid",label:t.showThumbs,"default":"checked",onChange:M,commit:M,setup:O},{type:"checkbox",id:"openOnClickId",label:t.openOnClick,"default":"checked",onChange:M,commit:M,setup:O}]},{type:"select",id:"imglistitemsid",label:t.picturesList,multiple:false,style:"height:120px;width:250px",items:[],onChange:function(e){d(this)}},{type:"vbox",children:[{type:"button",id:"previewbtn",style:"margin-top:15px;margin-left:25px;",label:t.previewMode,onClick:function(){T(this.getDialog())}},{type:"button",id:"removeselectedbtn",style:"margin-left:25px;",label:t.imgDelete,onClick:function(){b(this.getDialog())}},{type:"button",id:"editselectedbtn",style:"margin-left:25px;",label:t.imgEdit,onClick:function(){y(this.getDialog())}}]}]},{type:"hbox",children:[{type:"text",id:"pictheightid",label:t.pictHeight,maxLength:3,style:"width:100px;","default":"300",onChange:function(e){var t=/^\d+$/;if(t.test(this.getValue())==false){this.setValue(300)}this.getDialog().params.updateVal(this.id,this.getValue());p(this.getDialog())},commit:M,setup:O},{type:"text",id:"speedid",label:t.displayTime,maxLength:3,style:"width:100px;","default":"5",onChange:function(e){var t=/^\d+$/;if(t.test(this.getValue())==false){this.setValue(5)}this.getDialog().params.updateVal(this.id,this.getValue());p(this.getDialog())},commit:M,setup:O},{type:"text",id:"animspeedid",label:t.transitionTime,style:"width:100px;",maxLength:4,"default":"500",onChange:function(e){var t=/^\d+$/;if(t.test(this.getValue())==false){this.setValue(500)}this.getDialog().params.updateVal(this.id,this.getValue());p(this.getDialog())},commit:M,setup:O},{type:"select",id:"transitiontypeid",label:t.transition,items:[[t.tr1,"none"],[t.tr2,"resize"],[t.tr3,"slide-vert"],[t.tr4,"slide-hori"],[t.tr5,"fade"]],"default":"resize",style:"width:100px;",commit:M,setup:O,onChange:M}]}]}]}],onLoad:function(){},onShow:function(){this.dialog=this;this.slideshowDOM=null;this.openCloseStep=true;this.fakeImage=null;var t=null;this.imagesList=new Array;this.params=new Array;this.previewImage=e.document.createElement("img");this.okRefresh=true;var n=this.getSelectedElement();if(n&&n.data("cke-real-element-type")&&n.data("cke-real-element-type")=="slideShow"){this.fakeImage=n;t=e.restoreRealElement(n)}if(!t){this.params.push(["slideshowid",P("slideShow")]);L(this);this.commitContent(this)}else{this.slideshowDOM=t;var r=H(this,t);if(r==null){alert("BIG Problem slideShowContainer !!");return false}var i=t.getAttribute("id");if(i==null){alert("BIG Problem slideshowid !!");return false}this.params.push(["slideshowid",i]);k(this,r);var s=t.$.dataset;for(param in s)this.params.push([param,s[param]]);this.setupContent(this,true);this.newSlideShowMode=false}this.openCloseStep=false;T(this)},onOk:function(){return false},onHide:function(){_(this)}}})
